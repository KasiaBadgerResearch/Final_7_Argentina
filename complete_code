# Does the percentage of the Argentine population using the internet coincide with the share of international tourism receipts in total exports between 1995 and 2020?

import pandas as pd
import matplotlib.pyplot as plt
import os

# Folders
data_raw_folder = "data_raw/"
data_clean_folder = "data_clean/"
figures_folder = "figures/"

# Load CSV
filename = "argentina_combined.csv"  # Filtered dataset with only relevant rows
df = pd.read_csv(os.path.join(data_raw_folder, filename))

# Keep only needed columns
df = df[["Year", "Indicator Name", "Value"]]

# Convert Year and Value to numeric, drop invalid rows
df["Year"] = pd.to_numeric(df["Year"], errors="coerce")
df["Value"] = pd.to_numeric(df["Value"], errors="coerce")
df = df.dropna(subset=["Year", "Value"])

# Pivot indicators into separate columns
df_pivot = df.pivot(index="Year", columns="Indicator Name", values="Value").reset_index()
df_pivot = df_pivot.sort_values("Year")

print("Pivoted Argentina dataset:")
display(df_pivot)

# Interpolate missing values for smooth plotting (optional)
df_plot = df_pivot.interpolate(method='linear')

# Plot the two indicators
plt.figure(figsize=(10,6))
plt.plot(df_plot["Year"], df_plot["International tourism, receipts (% of total exports)"], 
         marker='o', linestyle='-', label="International tourism, receipts (% of total exports)")
plt.plot(df_plot["Year"], df_plot["Individuals using the Internet (% of population)"], 
         marker='o', linestyle='-', label="Individuals using the Internet (% of population)")

plt.title("Argentina: International Tourism vs Individuals Using the Internet (1995-2020)")
plt.xlabel("Year")
plt.ylabel("Percentage")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(os.path.join(figures_folder, "argentina_international_tourism_vs_individuals_using_internet.png"))
plt.show()

# Save cleaned CSV
df_pivot.to_csv(os.path.join(data_clean_folder, "argentina_international_tourism_vs_individuals_using_internet"), index=False)
